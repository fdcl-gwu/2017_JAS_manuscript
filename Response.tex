\documentclass[11pt]{article}
\usepackage{jas_packages}
\usepackage{fix-cm}
\usepackage{jas_tikz_packages}
\tdplotsetmaincoords{60}{125} % view angle in spherical coordinates
\input{macros}
\usepackage[letterpaper,margin=1in,centering]{geometry}
\usepackage{graphicx}
\usepackage{amssymb}  
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{siunitx}
\usepackage{mathtools}
\usepackage{microtype}
\usepackage{color}
\usepackage{bm}
\usepackage{xr-hyper}
% \usepackage{nameref,zref-xr}
\usepackage{hyperref}
\usepackage[]{cleveref} % get fancy referencing

% \zexternaldocument{manuscript}
\externaldocument[]{manuscript}[manuscript.pdf]

% \usepackage{xcite}
% \externalcitedocument{manuscript}
% edit cref citations for IEEE format
\crefformat{equation}{(#2#1#3)} % no abbreviation for equation numbers
\Crefformat{equation}{Equation~(#2#1#3)} % no abbreviation for equation numbers
\crefrangeformat{equation}{(#3#1#4--#5#2#6)}
\Crefrangeformat{equation}{(#3#1#4--#5#2#6)}
\crefmultiformat{equation}{(#2#1#3)}{ and~(#2#1#3)}{, (#2#1#3)}{ and~(#2#1#3)}
% edit cref citations for IEEE format
\crefformat{figure}{Fig.~#2#1#3} % no abbreviation for equation numbers
\Crefformat{figure}{Fig.~#2#1#3} % no abbreviation for equation numbers
\crefrangeformat{figure}{Figs.~#3#1#4--#5#2#6}
\Crefrangeformat{figure}{Figs.~#3#1#4--#5#2#6}
\crefmultiformat{figure}{Figs.~#2#1#3}{ and~#2#1#3}{, #2#1#3}{ and~#2#1#3}
% for items in a list
\crefformat{enumi}{(#2#1#3)}
\Crefformat{enumi}{Item~(#2#1#3)} 
\crefrangeformat{enumi}{(#3#1#4--#5#2#6)}
\Crefrangeformat{enumi}{Items~(#3#1#4--#5#2#6)}
\crefmultiformat{enumi}{(#2#1#3)}{ and~(#2#1#3)}{, (#2#1#3)}{ and~(#2#1#3)}
% Proposition format
\crefformat{prop}{Proposition~#2#1#3} % no abbreviation for equation numbers
\Crefformat{prop}{Proposition~#2#1#3} % no abbreviation for equation numbers
\crefrangeformat{prop}{Proposition~#3#1#4--#5#2#6}
\Crefrangeformat{prop}{Propositions~#3#1#4--#5#2#6}
\crefmultiformat{prop}{Propositions~#2#1#3}{ and~#2#1#3}{, #2#1#3}{ and~#2#1#3}
% Appendix
\crefformat{appendix}{Appendix~#2#1#3} % no abbreviation for equation numbers
\Crefformat{appendix}{Appendix~#2#1#3} % no abbreviation for equation numbers
\crefrangeformat{appendix}{Appendices~#3#1#4--#5#2#6}
\Crefrangeformat{appendix}{Appendices~#3#1#4--#5#2#6}
\crefmultiformat{appendix}{Appendices~#2#1#3}{ and~#2#1#3}{, #2#1#3}{ and~#2#1#3}

\newcommand{\RNum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}
\newcommand{\RI}{\text{\RNum{1}}}
\newcommand{\RII}{\text{\RNum{2}}}
\newcommand{\RIII}{\text{\RNum{3}}}

\newtheorem{definition}{Definition}
\newtheorem{lem}{Lemma}
\newtheorem{prop}{Proposition}
\newtheorem{cor}{Corollary}

\newenvironment{correction}{\begin{list}{}{\setlength{\leftmargin}{1cm}\setlength{\rightmargin}{1cm}}\vspace{\parsep}\item[]``}{''\end{list}}

\newcommand{\EditTL}[1]{{\color{red}\protect #1}}
%\renewcommand{\EditTL}[1]{{\protect #1}}


\begin{document}

%\pagestyle{empty}

\section*{Third round of responses to the reviewers' comments for JASS-D-17-00005}

We thank the reviewers for their comments and aid in improving the quality of our manuscript. 
In accordance with the comments and suggestions, the manuscript has been revised, and the answers to all comments are addressed as follow.

\subsection*{Reviewer 1}
\begin{itshape}
    I appreciate all of the authors' hard work in organizing two very detailed revisions for this journal submission.  I've reviewed the second round of revisions and I believe that all of my concerns have been addressed.  My opinion is that this paper is worthy of publication by JAS.  Thank you for the interesting read.
\end{itshape}

Thank you for the comments.

\subsection*{Reviewer 2}
\begin{itshape}
    I thank the authors for their significant additional improvements relative
    to the previous version of the manuscript, as well as for the organized
    structure of their response.  Many of my previous points have been
    addressed to a satisfactory degree.  The expositional sections of the paper
    are in much better shape and there are a number of clarifications and
    better acknowledgment of assumptions, pros/cons etc.  The parametric
    analysis in the first example is perhaps a bit more limited than I hoped
    for, but is still a good addition.
\end{itshape}

Thank you for the comments. 


\begin{itemize}
    \item 
        \begin{itshape}
            The primary remaining issue for me stems from my previous remark that
            appears at the end of page 10 of the most recent response document.  The
            author response on page 13 of that document has not resolved my concerns,
            but rather it has made the nature of the persisting issue more clear to me
            (e.g. through the clarification that the Jacobi energy is not identical for
            all points on the (x,xdot) plots.)

            I'll first discuss this in terms of merely minor issues for Sec 4.1.  This
            uses a single stage of reachability analysis, and the initial and final
            orbits have different energy levels.  However, the corresponding discussion
            in the middle paragraph of page 15 remarks upon an "intersection" between
            the unstable manifold of the initial orbit (E=-1.58 from Fig 9e) and the
            final orbit (E=-1.62 from Fig 9e).  The middle of page 18 then contains a
            correct description that acknowledges the Jacobi differences, which are
            handled by the boundary values of the optimization problem.  The following
            paragraph then again describes that "a small portion of the invariant
            manifold intersects with the target Moon orbit" and alludes that a
            "secondary impulsive maneuver" would be necessary to complete the transfer.
            This is the first place where the implications of (x,xdot) intersections at
            different energy levels are actively discussed, and it seems conceptually
            odd to consider targeting impulsive transfers in this way since they do not
            require xdot to be matched as a precondition.  So, Sec 4.1 would benefit
            from a more clear treatment of the ydot/Jacobi dimension, but the results
            are still valid, and the Jacobi plot implies a sensible solution (first
            raise energy to travel faster, then lower energy to match the target).
        \end{itshape}

        The authors appreciate these comments. 
        As suggested Section 4.1 is completely revised to clarity the following properties of the proposed approach.
        \begin{itemize}
            \item Due to the change of the Jacobi integral under low-thrust propulsion, the intersection between the rechability set and the stable manifold to the desired periodic orbit is computed in a lower-dimensional space, specifically excluding $\dot y$. 
            \item Once the intersection is found in the lower dimensional Poincare section, the missing value of $\dot y$ is computed from the Jacobi integral values of the desired periodic orbit. 
                This specifies the complete target state among the desired period orbit.
            \item Finally, an optimal control problem is solved with the target state defined in the previous step.
        \end{itemize}
        More specifically, the statements pointed out in the review are revised, and the following paragraph is added. 
        \begin{correction}
            TO DO
        \end{correction}

    \item
        \begin{itshape}
            The ydot/Jacobi treatment becomes much more problematic in Sec 4.2.  Its
            second paragraph again describes achieving an "intersection" of the
            reachability set and the target orbit, and an intermediate criterion of
            minimizing the (x,xdot) distance toward the target. Page 22 line 15 again
            describes the objective as enlarging the reachability set on the (x,xdot)
            plane to include the intersections of the target manifold, and the
            walk-through of Fig 11 discusses closing the gap in terms of (x,xdot)
            alone.  In Sec 4.1, it was presuambly the case that the reachable set
            projected onto (x,xdot) always had the Jacobi value of the target orbit.
            This can't be the case for Figs 11-12.  Further, the uncontrolled dynamics
            are in no way represented or accounted for (which, for example, cause a big
            jump between stages 3 and 4 that is not due to the influence of control).
            If I'm interpreting this right, the final maneuver is solely to make up for
            the large remaining distance in Jacobi energy after (x,xdot) are already
            matched.

            What is really going on with this method is that we are traversing a
            (x,xdot,E) cube from a point on the E=E0 side to a manifold on the opposite
            side where E=Etgt, and at each crossing of y=0 the reachable set is a 3D
            volume.  For Sec 4.1, we only care about the intersection of our reachable
            set with the E=Etgt manifold, and so the 2D (x,xdot) reasoning makes sense.
            But the multi-use approach is only reasoning about the (x,xdot) plane for a
            single horizon with fixed transfer time, presumably with the E dimension
            being reduced to whichever values maximize (x,xdot) distance, in which case
            the red and blue points in Figs 11-12 might all have different energy
            levels.  Fig 13c seems to disprove that the (x,xdot) distance is a good
            heuristic for receding-horizon use of this scheme, since the resulting path
            to the manifold is nothing at all like a straight line to the closest part
            of it.  Furthermore, the spread of these points is about as much as the
            spread of the reachable set in some individual stages such as stage 6.  Fig
            13e is also not indicative of an efficient transfer; to me, the highly
            nonmonotonic behavior suggest that a lot of fuel is being wasted to ensure
            that y=0 is crossed at a rather arbitrary sequence of times.

            As painful as it is to prolong the review process any more, I cannot
            approve publication of the paper considering the extent of the problems
            with the example of 4.2 (barring that the remaining reviewer and the editor
            identify some way in which I am mistaken or have missed something).  The
            authors have been very accommodating in making extensive updates to the
            organization and writing of the paper, but have not adequately addressed
            matters relating to the fundamental contributions. What it would take for
            me to enthusiastically accept this manuscript is either for the mutli-rev
            use of the method to be implemented in a better-reasoned way with a more
            demonstrably good solution (I'm not sure how) or for example 4.2 to be
            dropped and for the single-use case to be analyzed in more depth (some
            steps were taken toward that in this revision). At a very minimum, all the
            aspects I have mentioned need to at least be acknowledged as limitations
            of the method/as being counter to some of the assumptions of the 
            formulation.
        \end{itshape}


        The authors agree with most of these comments, and we appreciate the thoughtful insights. 
        As stated in the previous response, the intersection between the reachability set and the stable manifold to the desired periodic orbit is computed in the lower-dimensional space, and as such, the energy error in the last stage should be corrected by an additional optimization scheme. 

        However, the example in Section 4.2 illustrates that the proposed approach can be linked together to compute low-thrust transfers for more challenging maneuvers, with the requirement of correcting energy error at the last stage. 
        Such issue remains in the single stage example in Section 4.1. 
        If needed in the multi stage examples, the Jacobi energy can be corrected in the intermediate steps to reduce the energy gap in the last stage. 

        This paper is motivated by the current common practice of computing low thrust orbital transfers, where a large set of initial guess is repeatedly optimized in a computationally intensive manner. 
        The main contribution is presenting an alternative framework of constructing low thrust orbital transfers in a more efficient and systematic fashion. 
        And, the example in Section 4.2 demonstrates such capability. 

        In the revised manuscript, the following paragraph is added in Section 4.2 to explicitly describe the requirement of energy correction at the last stage, its implication and potential difficulties. 

        \begin{correction}
            TODO
        \end{correction}

        In the current practice of academic publication, if a new idea is presented in a manuscript and both of the desirable properties and the potential issues are illustrated explicitly, it is considered to be worth of sharing. 
        The example in Section 4.2 demonstrates an interesting application of the proposed approach, and more importantly, it also illustrates a case where the limitation of the proposed approach can be problematic.
        As such, it provides candid, explicit characterization of the proposed approach, as well as topics for prospective research. 
        The authors do not agree with the comments that Section 4.2 should be excluded due to the deficiencies. 
        Instead, the limitations of the proposed approach illustrated by Section 4.2 are explicitly stated in the revised manuscript.

    \item
        \begin{itshape}

            Given the significant remaining issues above, I am going to keep further
            feedback a bit more brief:

            * As mentioned before, at a high level, transferring onto the stable
            manifold kind of undercuts the premise of using low thrust to reduce the
            transfer time
        \end{itshape}

        In this paper, the natural, uncontrolled dynamics represented by stable manifold are considered as a good starting point for low thrust orbital transfers, as orbital maneuvers with low thrust over a short time period would not differ from those substantially. 
        But, as pointed out by the reviewer, the proposed approach does not impose any optimality in the constructed maneuver. 
        The scope of this paper is constructing low thrust orbital maneuvers without relying on massive computations. 
        To clarify these, the revised manuscripts states that there is no optimality guaranteed.

    \item
        \begin{itshape}

            * The extra analysis behind Fig 8 is a step in the right direction, but in
            practice it is hard to make sense of, and might require additional
            figures/better color choices.  Why are all the reachable sets nearly
            straight lines, when we expected some kind of closed path to arise from
            sweeping 0 < theta < 360?  Why are some progressions of sets so irregular
            (e.g. red cross --> blue cross --> green cross --> yellow cross signifying
            increase in travel time with fixed large umax, which results in darting
            back and forth in the x dimension)?  The 25 lines of discussion do not
            acknowledge these oddities, nor do they seem to completely line up with the
            figure.  There seem to remain unexplored/unexplained relationships that
            would in practice need to be used to justify parameter choices by anyone
            applying this method.   
        \end{itshape}

    \item
        \begin{itshape}

            * As mentioned before, the Poincare illustrations of Fig 2 and 3 would be
            more helpful if they were more general.  The first could benefit from
            showing nonperiodic dynamics, the second from showing a non-circular
            reachable boundary (I know the text acknowledges this but please update the
            figure).  
        \end{itshape}

    \item
        \begin{itshape}

            * I wonder under what circumstances the reachable set might intersect a
            given $\theta_d$ in multiple places.  This is something that could be looked
            into to expand the strength of a submission focusing only on the
            single-horizon use of the method.
        \end{itshape}

    \item 
        \begin{itshape}

            * There are still some very long single paragraphs in the paper.
        \end{itshape}

\end{itemize}

\bibliography{library}
\bibliographystyle{spmpsci}
\end{document}

